# 📖 新手完整教學

> 這個教學適合完全沒有程式經驗的人。我們會一步一步帶你設定一個自動抓取 YouTube 熱門影片的系統！

## 📋 你需要什麼？

- 一個 Google 帳號（有 Gmail 就有）
- 一台能上網的電腦
- 大約 30 分鐘的時間

## 🎯 我們要做什麼？

設定一個系統，讓它：

1. 每天自動抓取美國、印度、台灣的熱門影片
2. 把資料整理到 Google 試算表
3. 追蹤影片的觀看次數變化
4. 還能提供 API 讓你查詢資料

---

## 步驟 1：建立你的「程式專案」📁

### 1.1 開啟 Google Apps Script

- 在瀏覽器輸入：[script.google.com](https://script.google.com/)
- 用你的 Google 帳號登入

### 1.2 建立新專案

- 點擊左上角藍色的「新增專案」按鈕
- 會看到一個寫程式的介面（不用怕！）

### 1.3 複製我們的程式碼

**重要：建議使用重構版本，程式碼更簡潔易懂**

- 開啟專案中的 `ai_youtube_webapp_refactored.gs` 檔案
- **全選複製**所有內容
- 回到 Google Apps Script，**全選**編輯器中的內容（通常是空的或有範例程式）
- **貼上**我們的程式碼

### 1.4 重新命名專案

- 點擊左上角的「未命名專案」
- 改名為「YouTube熱門影片追蹤系統」或你喜歡的名字

---

## 步驟 2：開啟 YouTube 資料功能🔑

**為什麼要做這步？** 我們的程式需要跟 YouTube 要資料，Google 要先確認你有權限。

### 2.1 在 Apps Script 中啟用

1. 看到左側選單，點擊「服務」（Services）
2. 點擊「新增服務」旁邊的 ➕ 號
3. 在彈出視窗中搜尋：`YouTube Data API v3`
4. 找到後點擊「新增」

### 2.2 在 Google Cloud 中啟用

1. 開新分頁，前往：[console.cloud.google.com](https://console.cloud.google.com/)
2. 登入同一個 Google 帳號
3. 在上方選擇你的專案（名稱會跟你剛才建立的一樣）
4. 左側選單找到「API 和服務」→「程式庫」
5. 搜尋：`YouTube Data API v3`
6. 點擊進入，然後點擊藍色「啟用」按鈕

---

## 步驟 3：測試程式是否能運作🧪

### 3.1 第一次執行測試

1. **回到 Apps Script 分頁**
2. **選擇測試函數**
   - 在程式編輯器上方，找到函數下拉選單
   - 選擇 `testGetTrending`

3. **授權程式**（第一次執行需要）
   - 點擊「執行」按鈕（播放符號）
   - 會跳出授權視窗，點擊「檢視權限」
   - 選擇你的 Google 帳號
   - 看到「Google 尚未驗證這個應用程式」，點擊「進階」
   - 點擊「前往 [專案名稱]（不安全）」
   - 點擊「允許」

4. **查看結果**
   - 點擊下方的「執行記錄」
   - 如果看到影片資料，恭喜！程式運作正常 🎉

---

## 步驟 4：設定每日自動執行⏰

### 4.1 設定自動排程

- 在函數下拉選單選擇 `setupDailyTrigger`
- 點擊「執行」
- 看到「每日觸發器設定完成！」就成功了

### 4.2 檢查是否設定成功

- 選擇 `checkSystemStatus` 並執行
- 應該會看到「觸發器數量: 1」

---

## 步驟 5：測試完整追蹤系統📊

### 5.1 執行完整測試

- 選擇 `testDailyTracking` 並執行
- 這會建立 Google 試算表並開始抓資料
- 第一次執行需要 2-3 分鐘

### 5.2 查看你的資料表

- 選擇 `checkSystemStatus` 並執行
- 在執行記錄中會看到 Google 試算表的連結
- 點擊連結就能看到你的資料！

**你會看到什麼？**
- 一個名為「YouTube 熱門影片追蹤」的 Google 試算表
- 包含來自美國、印度、台灣的熱門影片資料
- 每個影片都有標題、觀看次數、發布時間等資訊

---

## 步驟 6：設定 API 功能（選用）🌐

如果你想要讓其他人也能查詢你的資料：

### 6.1 部署為網路應用程式

- 點擊右上角「部署」→「新增部署」
- 類型選擇「網路應用程式」
- 存取權限選擇「任何人」
- 點擊「部署」

### 6.2 取得 API 網址

- 複製產生的網址
- 這就是你的 API！別人可以用這個網址查詢資料

**測試你的 API：**
- 把網址貼到瀏覽器中
- 應該會看到 JSON 格式的影片資料

---

## 🔧 疑難排解

### 常見問題與解決方法

**❌ 「YouTube is not defined」**
- **原因**：沒有啟用 YouTube Data API v3
- **解決**：重新完成步驟 2

**❌ 「配額已用盡」**
- **原因**：今天的 API 使用量用完了
- **解決**：明天再試，或在 Google Cloud Console 申請提高配額

**❌ 「權限不足」**
- **原因**：授權有問題
- **解決**：重新執行步驟 3 的授權流程

**❌ 「找不到工作表」**
- **原因**：Google 試算表建立失敗
- **解決**：執行 `testDailyTracking` 重新建立

### 如何檢查系統狀態

想知道系統運作是否正常？執行這些函數：

- **檢查整體狀態**：`checkSystemStatus`
- **手動測試搜尋**：`testGetTrending`
- **手動執行追蹤**：`testDailyTracking`
- **移除自動執行**：`removeDailyTrigger`

---

## 💡 給新手的小提醒

### 基本概念

1. **什麼是 API？**
   - 就像餐廳的菜單，你點菜（發送請求），餐廳給你食物（回傳資料）
   - 我們的系統就是一個「YouTube 資料餐廳」

2. **什麼是 Google Sheets？**
   - 就是 Google 版的 Excel
   - 我們的程式會自動把抓到的資料整理到這裡

3. **什麼是自動執行？**
   - 就像設定鬧鐘，每天早上 6 點程式會自動醒來工作

### 安全須知

1. **不要害怕出錯**：程式出錯很正常，照著錯誤訊息處理就好
2. **資料安全**：你的 Google 試算表只有你能看到
3. **API 限制**：每天免費額度有限，不要無限制測試
4. **定期檢查**：建議每週檢查一次系統是否正常運作

### 進階學習

如果你想深入了解：

1. **程式邏輯**：可以嘗試閱讀程式碼中的註解
2. **API 參數**：參考 [develop.md](./develop.md) 了解更多設定選項
3. **資料分析**：學習如何在 Google Sheets 中分析資料

---

## 🎉 恭喜完成！

你現在擁有了一個全自動的 YouTube 熱門影片追蹤系統！

**系統每天會自動：**
- 抓取美國、印度、台灣的熱門影片
- 記錄觀看次數變化
- 整理資料到 Google 試算表
- 提供 API 供你查詢資料

**接下來你可以：**
- 觀察不同地區的影片趨勢
- 分析哪些類型的內容最受歡迎
- 追蹤特定影片的成長軌跡
- 用資料做出更好的內容決策

有問題的話，記得查看疑難排解章節，或是參考 [develop.md](./develop.md) 的技術細節！

---

**最後更新：** 2025-09-16