# 📖 新手完整教學

> 這個教學適合完全沒有程式經驗的人。我們會一步一步帶你設定一個自動抓取 YouTube 熱門影片排名的系統！

## 📋 你需要什麼？

- 一個 Google 帳號（有 Gmail 就有）
- 一台能上網的電腦
- 大約 20 分鐘的時間（比之前更簡單了！）

## 🎯 我們要做什麼？

設定一個全自動系統，讓它：

1. **🏆 追蹤排名**：每天自動追蹤美國、印度、台灣的熱門影片排名
2. **🎬 智能分類**：自動區分一般影片和 Shorts 短影片（≤60秒）
3. **📈 趨勢分析**：追蹤觀看數、按讚數、留言數的每日變化
4. **📊 數據整理**：把所有資料整理到 Google 試算表（16 欄完整數據）
5. **🔄 自動更新**：每天早上 6 點自動執行，完全不用管

**✨ v3.0 新功能：**
- 排名系統：美國影片第 1 名、台灣 Shorts 第 5 名
- 智能 Shorts 判斷：基於實際影片長度，不再依賴不準確的標籤
- 一鍵設置：只要執行一個函數就完成所有設定！

---

## 🚀 超簡單！兩步驟完成設置

### 步驟 1：建立你的程式專案 📁

#### 1.1 開啟 Google Apps Script
- 在瀏覽器輸入：[script.google.com](https://script.google.com/)
- 用你的 Google 帳號登入

#### 1.2 建立新專案
- 點擊左上角藍色的「新增專案」按鈕
- 重新命名為「YouTube熱門影片追蹤系統」

#### 1.3 複製程式碼
- 開啟專案中的 `ai_youtube_webapp.gs` 檔案
- **全選複製**所有內容（約 800 行，已經過精簡優化）
- 回到 Google Apps Script，**全選並刪除**編輯器中的內容
- **貼上**我們的程式碼

### 步驟 2：啟用 YouTube 資料功能 🔑

#### 2.1 在 Apps Script 中啟用
1. 看到左側選單，點擊「服務」（Services）
2. 點擊「新增服務」旁邊的 ➕ 號
3. 搜尋並新增：`YouTube Data API v3`

#### 2.2 在 Google Cloud 中啟用
1. 前往：[console.cloud.google.com](https://console.cloud.google.com/)
2. 選擇你的專案 → API 和服務 → 程式庫
3. 搜尋 `YouTube Data API v3` → 啟用

---

## 🎉 一鍵完成所有設置！

### 🌟 執行魔法函數：setupSystem()

**這就是 v3.0 的最大改進！** 不需要複雜的多步驟設置，一個函數搞定一切：

1. **找到函數**
   - 在程式編輯器上方的函數下拉選單
   - 選擇 `setupSystem`（應該在最上面，新手友好設計）

2. **首次授權**
   - 點擊「執行」按鈕（▶️）
   - 會跳出授權視窗：
     - 點擊「檢視權限」
     - 選擇你的 Google 帳號
     - 看到「Google 尚未驗證這個應用程式」→ 點擊「進階」
     - 點擊「前往 [專案名稱]（不安全）」
     - 點擊「允許」

3. **等待完成**
   - 系統會自動執行 2-3 分鐘
   - 在「執行記錄」中查看進度

### 🎯 setupSystem() 會自動完成：

✅ **創建 Google Sheet**：16 欄位完整結構，包含排名、影片長度等
✅ **設置自動排程**：每天早上 6:00 自動執行追蹤
✅ **測試 API 連接**：確保能正常抓取 YouTube 資料
✅ **提供 Sheet 連結**：直接給你 Google 試算表的連結

**執行完成後你會看到：**
```
🎉 系統初始化完成！
📋 Google Sheet (16 欄): https://docs.google.com/spreadsheets/d/...
⏰ 每日追蹤: 已啟用 (06:00)
🎯 立即測試: 執行 dailyYouTubeTracking()
```

---

## 📊 立即查看你的數據！

### 🎬 執行第二個函數：dailyYouTubeTracking()

想馬上看到數據？執行這個函數：

1. 選擇 `dailyYouTubeTracking` 函數
2. 點擊執行
3. 等待 3-5 分鐘（第一次會比較久）
4. 點擊執行記錄中的 Google Sheet 連結

### 🏆 你會看到什麼精彩數據？

**美國地區（US）：**
- 🎥 videos: 排名 1-20 的熱門影片
- 📱 shorts: 排名 1-20 的熱門 Shorts（≤60秒）

**印度地區（IN）：**
- 🎥 videos: 排名 1-20 的熱門影片
- 📱 shorts: 排名 1-20 的熱門 Shorts

**台灣地區（TW）：**
- 🎥 videos: 排名 1-20 的熱門影片
- 📱 shorts: 排名 1-20 的熱門 Shorts

**每個影片包含：**
- 🥇 排名、📺 影片 ID、📝 標題、👤 頻道名稱
- 📅 發佈時間、🌍 地區、🎬 類型
- 📈 觀看數歷史、👍 按讚數歷史、💬 留言數歷史
- ⏱️ 影片長度（秒）、🏷️ hashtags

---

## 🔧 系統管理（選用）

### 檢查系統狀態
執行 `checkSystemStatus()` 查看：
- ✅ 觸發器狀態
- ✅ Google Sheet 記錄數量
- ✅ 系統配置資訊

### 調整系統參數（進階）
想要修改追蹤範圍？編輯程式頂部的常量：
```javascript
const DAILY_SEARCH_DAYS = 5;        // 搜尋過去幾天
const RANKING_LIMIT = 20;           // 每個地區保留幾名
const SHORTS_DURATION_LIMIT = 60;   // Shorts 長度閾值（秒）
```

### 停用自動追蹤
執行 `removeDailyTrigger()` 即可停止每日自動執行

---

## 🌐 設定 API 功能（選用）

想讓其他人查詢你的資料？

### 部署為網路應用程式
1. 點擊「部署」→「新增部署」
2. 類型：「網路應用程式」
3. 存取權限：「任何人」
4. 點擊「部署」

### 測試你的 API
- 複製產生的網址貼到瀏覽器
- 會看到 JSON 格式的最新影片資料
- 可以加參數：`?regionCode=TW&days=3&max=10`

---

## 🔧 疑難排解

### 常見問題

**❌ 「YouTube is not defined」**
- 解決：重新完成步驟 2（啟用 YouTube Data API v3）

**❌ 「配額已用盡」**
- 原因：YouTube API 每日免費額度用完
- 解決：隔天再試，或在 Google Cloud Console 提高配額

**❌ 「權限不足」或授權問題**
- 解決：重新執行 `setupSystem()` 重新授權

**❌ 系統沒有自動執行**
- 檢查：執行 `checkSystemStatus()` 確認觸發器狀態
- 重設：執行 `setupDailyTrigger()` 重新設定

**❌ 發現 Shorts 分類不準確**
- v3.0 已修正：現在基於實際影片長度判斷，更準確！

### 系統狀態檢查函數

- `checkSystemStatus()` - 檢查整體狀態
- `setupSystem()` - 重新初始化（萬能修復）
- `dailyYouTubeTracking()` - 手動執行追蹤
- `setupDailyTrigger()` - 重設自動執行
- `removeDailyTrigger()` - 移除自動執行

---

## 🎯 數據分析建議

### 📈 趨勢分析
- **排名變化**：觀察影片排名的上升下降
- **觀看成長**：比較不同地區的觀看數增長模式
- **互動比率**：計算按讚數/觀看數，留言數/觀看數
- **內容長度**：分析成功影片的長度分布

### 🌍 地區比較
- **美國 vs 印度 vs 台灣**：內容偏好差異
- **Shorts vs 一般影片**：不同類型的表現差異
- **發佈時間**：分析最佳發佈時機

### 🏷️ Hashtag 趨勢
- 追蹤熱門 hashtag 的變化
- 分析成功影片的 hashtag 策略

---

## 💡 給新手的小提醒

### 🌟 v3.0 的優勢
1. **一鍵設置**：不用記住複雜步驟，`setupSystem()` 搞定一切
2. **智能分類**：真正的 Shorts（≤60秒）vs 一般影片
3. **排名系統**：清楚的地區和類型排名
4. **豐富數據**：16 欄完整數據，包含趨勢分析
5. **新手友好**：重要函數放在最前面，容易找到

### 安全須知
- 你的資料只有你能看到（除非你主動分享）
- 系統每天只消耗很少的 API 配額（0.12%）
- 可以隨時停用或修改設定

### 學習建議
- 先讓系統運行幾天，累積一些資料
- 學習在 Google Sheets 中使用圖表功能
- 嘗試分析不同地區和類型的趨勢差異

---

## 🎉 恭喜！你的智能追蹤系統完成了

**🏆 你現在擁有的系統功能：**

✅ **全自動排名追蹤**：3個地區 × 2種類型 × 20名排名 = 120 個熱門影片
✅ **智能分類系統**：準確區分 Shorts 和一般影片
✅ **完整趨勢分析**：觀看、按讚、留言數歷史追蹤
✅ **豐富數據結構**：16 欄完整資訊，包含影片長度、hashtags
✅ **每日自動更新**：早上 6 點自動執行，無需人工干預
✅ **Web API 介面**：可供其他應用程式查詢資料

**🎯 接下來你可以：**
- 觀察跨地區的內容趨勢差異
- 分析 Shorts 和一般影片的成功模式
- 追蹤熱門 hashtag 的變化
- 研究觀看數和互動數的關係
- 建立你自己的內容策略數據庫

**有問題？** 記得善用 `checkSystemStatus()` 檢查系統狀態，或參考 [develop.md](./develop.md) 了解技術細節！

---

**最後更新：** 2025-09-16 - v3.0.0 趨勢分析完整版